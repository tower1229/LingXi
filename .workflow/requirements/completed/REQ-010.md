# REQ-010: 统一安装清单配置化

| 属性     | 值       |
| -------- | -------- |
| 版本     | 1.0      |
| 状态     | 草稿     |
| 创建日期 | 2025-01-27 |
| 需求类型 | 简单功能 |
| 复杂度   | 简单     |

---

## 1. 概述

### 1.1 背景

当前项目包含多个安装脚本（`install.sh`、`install.js`、`install-remote.sh`、`install.ps1`），这些脚本中重复罗列了需要安装的文件清单（commands、rules、hooks、skills 等）。当需要添加或修改安装文件时，需要在所有脚本中同步更新，维护成本高且容易遗漏。

### 1.2 问题描述

1. **代码重复**：四个安装脚本中都硬编码了相同的文件清单
2. **维护困难**：新增或删除文件时需要在多个脚本中同步修改
3. **易出错**：容易出现遗漏或不同步的情况

### 1.3 解决方案概述

创建一个固定格式的安装清单配置文件（如 JSON 或 YAML），将所有需要安装的文件清单统一管理。各个安装脚本读取同一份清单文件，实现配置化的安装流程。

---

## 2. 目标

| 编号 | 目标 | 优先级   |
| ---- | ---- | -------- |
| G1   | 创建统一的安装清单配置文件 | 必须实现 |
| G2   | 修改各安装脚本以读取清单文件 | 必须实现 |
| G3   | 确保所有安装脚本功能保持一致 | 必须实现 |

---

## 3. 功能需求

| 编号 | 需求描述 | 实现方案 | 验收标准 | 优先级   |
| ---- | -------- | -------- | -------- | -------- |
| F1   | 创建安装清单配置文件（JSON 格式） | `install-manifest.json`，包含 commands、rules、hooks、skills、references 等文件列表 | 文件格式规范，包含所有安装文件路径 | 必须实现 |
| F2   | 修改 `install.sh` 读取清单文件 | 添加 JSON 解析逻辑，替换硬编码的文件列表 | 脚本能正确读取并安装清单中的文件 | 必须实现 |
| F3   | 修改 `install.js` 读取清单文件 | 使用 Node.js 的 `fs` 和 `JSON.parse` 读取清单 | 脚本能正确读取并安装清单中的文件 | 必须实现 |
| F4   | 修改 `install-remote.sh` 读取清单文件 | 添加 JSON 解析逻辑（可能需要 `jq` 或纯 Bash 解析） | 脚本能正确从 GitHub 下载清单中的文件 | 必须实现 |
| F5   | 修改 `install.ps1` 读取清单文件 | 使用 PowerShell 的 `Get-Content` 和 `ConvertFrom-Json` | 脚本能正确从 GitHub 下载清单中的文件 | 必须实现 |

---

## 4. 验收检查清单

- [ ] `install-manifest.json` 文件已创建，格式规范
- [ ] `install-manifest.json` 包含所有现有的安装文件（commands、rules、hooks、skills、references）
- [ ] `install.sh` 能正确读取清单并安装文件（本地复制模式）
- [ ] `install.js` 能正确读取清单并安装文件（本地复制模式）
- [ ] `install-remote.sh` 能正确读取清单并下载文件（远程下载模式）
- [ ] `install.ps1` 能正确读取清单并下载文件（远程下载模式）
- [ ] 所有脚本安装的文件列表一致
- [ ] 添加新文件到清单后，所有脚本都能正确识别并安装
