# REQ-008: 优化 workflow 阶段菜单和推进判据检查体验

| 属性     | 值       |
| -------- | -------- |
| 版本     | 1.0      |
| 创建日期 | 2025-01-27 |
| 需求类型 | 简单功能 |
| 复杂度   | 简单     |

---

## 1. 概述

### 1.1 背景

当前 workflow 各阶段结束后的菜单格式挤在一行，可读性较差；菜单选项文案固定，不够直观；推进判据检查无论成功与否都会展示，信息冗余。

### 1.2 问题描述

1. **菜单格式问题**：当前菜单格式为 `A)补充/修改 B)下一阶段 C)回退 D)退出`，所有选项挤在一行，可读性差
2. **菜单文案问题**：
   - 选项A的文案固定为"补充/修改"，未根据当前环节动态变化（如 req 环节应为"继续修改/补充 需求"）
   - 选项B固定为"下一阶段"，未显示具体的下一阶段名称（如应显示"进入 plan"）
3. **跳过选项缺失**：audit 和 review 环节应该可以跳过，但 plan 和 work 环节的菜单中缺少跳过选项
4. **推进判据检查冗余**：每次进入新环节的推进判据检查都会展示成功检查的结果，应该只在异常时展示
5. **菜单提示语不友好**：阶段完成后的菜单前面展示的是"req 完成 → plan"这种抽象的字符，不够人类友好，应该改为更直观的提示语（如"需求文档已创建，您可以："）

### 1.3 解决方案概述

1. 将菜单格式改为每个选项一行的方式
2. 选项A文案根据当前环节动态变化（req→"继续修改/补充 需求"，plan→"继续修改/补充 计划"，work→"继续修改/补充 实现"，等）
3. 选项B显示具体的下一阶段名称（如"进入 plan"、"进入 audit"、"进入 work"等）
4. plan 环节菜单增加"跳过audit 直接 work"选项
5. work 环节菜单增加"跳过review 直接 archive"选项
6. 推进判据检查遵循静默成功原则，只在异常时展示检查结果
7. 菜单前添加人类友好的提示语，替代抽象的"阶段 完成 → 下一阶段"格式（如 req→"需求文档已创建，您可以："，plan→"计划文档已创建，您可以："等）

---

## 2. 目标

| 编号 | 目标 | 优先级   |
| ---- | ---- | -------- |
| G1   | 优化菜单格式，提升可读性 | 必须实现 |
| G2   | 菜单文案动态化，提升直观性 | 必须实现 |
| G3   | 增加跳过选项，提升灵活性 | 必须实现 |
| G4   | 推进判据检查静默成功，减少信息冗余 | 必须实现 |
| G5   | 菜单提示语人类友好化，替代抽象格式 | 必须实现 |

---

## 3. 验收检查清单

- [ ] req 阶段菜单前显示"需求文档已创建，您可以："，菜单格式为每行一个选项，选项A显示"继续修改/补充 需求"，选项B显示"进入 plan"
- [ ] plan 阶段菜单前显示"计划文档已创建，您可以："，菜单格式为每行一个选项，选项A显示"继续修改/补充 计划"，选项B显示"进入 audit"，选项C显示"跳过audit 直接 work"
- [ ] audit 阶段菜单前显示"审查完成，您可以："，菜单格式为每行一个选项，选项A显示"继续修改/补充 审查"，选项B显示"进入 work"
- [ ] work 阶段菜单前显示"实现完成，您可以："，菜单格式为每行一个选项，选项A显示"继续修改/补充 实现"，选项B显示"进入 review"，选项C显示"跳过review 直接 archive"
- [ ] review 阶段菜单前显示"审查完成，您可以："，菜单格式为每行一个选项，选项A显示"继续修改/补充 审查"，选项B显示"进入 archive"
- [ ] 所有阶段的推进判据检查只在异常时展示，成功时静默通过
- [ ] 修改涉及的所有 skill 文件（req、plan、audit、work、review、flow-router）
