# REQ-008 Plan

## 目标回放

优化 workflow 各阶段结束后的菜单格式和文案，提升可读性和直观性；增加跳过选项提升灵活性；推进判据检查遵循静默成功原则，减少信息冗余。

## 状态摘要（Status Summary）

- **当前阶段**：work
- **进度**：6/6
- **当前任务**：已完成
- **阻塞项**：无
- **上次更新**：2025-01-27

## 文件变更清单（Files to Change）

| 操作 | 文件路径 | 说明 |
|-----|---------|-----|
| 修改 | `.cursor/skills/req/SKILL.md` | 更新阶段完成输出格式和菜单文案 |
| 修改 | `.cursor/skills/plan/SKILL.md` | 更新阶段完成输出格式和菜单文案，添加跳过选项 |
| 修改 | `.cursor/skills/audit/SKILL.md` | 更新阶段完成输出格式和菜单文案 |
| 修改 | `.cursor/skills/work/SKILL.md` | 更新阶段完成输出格式和菜单文案，添加跳过选项 |
| 修改 | `.cursor/skills/review/SKILL.md` | 更新阶段完成输出格式和菜单文案 |
| 修改 | `.cursor/skills/flow-router/SKILL.md` | 更新阶段完成输出模板和推进判据检查逻辑 |

## 任务清单（Tasks）

### 修改任务

- [x] T1: 修改 req skill 的菜单格式和文案（依赖: 无）
  - 修改: `.cursor/skills/req/SKILL.md`
  - 更新阶段完成输出：添加人类友好提示语"需求文档已创建，您可以："
  - 更新菜单格式：每个选项一行
  - 更新选项A文案："继续修改/补充 需求"
  - 更新选项B文案："进入 plan"
  - 更新推进判据检查：只在异常时展示

- [x] T2: 修改 plan skill 的菜单格式和文案（依赖: 无）
  - 修改: `.cursor/skills/plan/SKILL.md`
  - 更新阶段完成输出：添加人类友好提示语"计划文档已创建，您可以："
  - 更新菜单格式：每个选项一行
  - 更新选项A文案："继续修改/补充 计划"
  - 更新选项B文案："进入 audit"
  - 添加选项C："跳过audit 直接 work"
  - 更新推进判据检查：只在异常时展示

- [x] T3: 修改 audit skill 的菜单格式和文案（依赖: 无）
  - 修改: `.cursor/skills/audit/SKILL.md`
  - 更新阶段完成输出：添加人类友好提示语"审查完成，您可以："
  - 更新菜单格式：每个选项一行
  - 更新选项A文案："继续修改/补充 审查"
  - 更新选项B文案："进入 work"
  - 更新推进判据检查：只在异常时展示

- [x] T4: 修改 work skill 的菜单格式和文案（依赖: 无）
  - 修改: `.cursor/skills/work/SKILL.md`
  - 更新阶段完成输出：添加人类友好提示语"实现完成，您可以："
  - 更新菜单格式：每个选项一行
  - 更新选项A文案："继续修改/补充 实现"
  - 更新选项B文案："进入 review"
  - 添加选项C："跳过review 直接 archive"
  - 更新推进判据检查：只在异常时展示

- [x] T5: 修改 review skill 的菜单格式和文案（依赖: 无）
  - 修改: `.cursor/skills/review/SKILL.md`
  - 更新阶段完成输出：添加人类友好提示语"审查完成，您可以："
  - 更新菜单格式：每个选项一行
  - 更新选项A文案："继续修改/补充 审查"
  - 更新选项B文案："进入 archive"
  - 更新推进判据检查：只在异常时展示

- [x] T6: 修改 flow-router skill 的模板和逻辑（依赖: 无）
  - 修改: `.cursor/skills/flow-router/SKILL.md`
  - 更新阶段完成输出模板：添加人类友好提示语示例
  - 更新推进判据检查说明：强调静默成功原则

## 交付物（Deliverables）

- [x] 代码变更：所有 6 个 skill 文件已更新
- [x] 菜单格式：所有阶段菜单改为每行一个选项
- [x] 菜单文案：所有阶段菜单文案已动态化
- [x] 跳过选项：plan 和 work 阶段已添加跳过选项
- [x] 推进判据检查：所有阶段遵循静默成功原则

## 测试规格（Test Specifications）

### 手工验证步骤

| 步骤 | 操作 | 预期行为 |
|-----|-----|---------|
| 1 | 执行 `/flow <描述>` 创建新需求，完成 req 阶段 | 菜单前显示"需求文档已创建，您可以："，菜单格式为每行一个选项，选项A显示"继续修改/补充 需求"，选项B显示"进入 plan" |
| 2 | 完成 plan 阶段 | 菜单前显示"计划文档已创建，您可以："，菜单格式为每行一个选项，选项A显示"继续修改/补充 计划"，选项B显示"进入 audit"，选项C显示"跳过audit 直接 work" |
| 3 | 完成 audit 阶段 | 菜单前显示"审查完成，您可以："，菜单格式为每行一个选项，选项A显示"继续修改/补充 审查"，选项B显示"进入 work" |
| 4 | 完成 work 阶段 | 菜单前显示"实现完成，您可以："，菜单格式为每行一个选项，选项A显示"继续修改/补充 实现"，选项B显示"进入 review"，选项C显示"跳过review 直接 archive" |
| 5 | 完成 review 阶段 | 菜单前显示"审查完成，您可以："，菜单格式为每行一个选项，选项A显示"继续修改/补充 审查"，选项B显示"进入 archive" |
| 6 | 选择进入下一阶段时，推进判据检查正常 | 推进判据检查只在异常时展示，成功时静默通过 |

## 复利候选（Compounding Candidates）

- [ ] （候选）菜单格式和文案的动态化模式可复用到其他命令或交互场景
