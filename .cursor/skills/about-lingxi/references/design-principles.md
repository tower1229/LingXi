# 灵犀设计原则

## 概述

本文档收录灵犀的核心设计原则，这些原则指导所有设计决策和实现。

## 核心设计原则

### 1. AI Native - 依赖大模型自然语言理解能力

**核心思想**：尽量依赖大模型的自然语言理解能力，而非硬编码规则匹配。

**触发条件**（何时应用此原则）：
- 设计 workflow 功能、命令或 Skill 时
- 需要处理用户的自然语言输入时
- 考虑是否要添加规则匹配逻辑（如关键词检测、模式识别）时
- 发现设计中出现复杂的 if-else 规则匹配逻辑时

**问题现象**（警示信号）：
- 设计文档中出现大量关键词列表、正则表达式或规则匹配逻辑
- 需要维护"模式识别规则"来判断用户意图
- 担心大模型无法理解用户的自然语言输入
- 倾向于用硬编码规则来"帮助"大模型理解

**解决方案**：
1. **用自然语言描述**：用清晰的自然语言描述处理策略和期望行为
2. **让大模型智能判断**：让大模型根据上下文和意图自动选择合适的处理方式
3. **避免硬编码规则**：避免关键词列表、正则表达式、复杂的 if-else 逻辑
4. **提供示例而非规则**：用示例场景说明期望行为，而非枚举所有可能的规则

**示例**：
- ❌ **传统方式**：定义关键词列表判断模式（如"刚才/刚才的" → 历史提取模式）
- ✅ **AI Native 方式**：描述"根据用户输入的自然语言意图，自动选择合适的处理方式"

### 2. 心有灵犀 - 项目级记忆

**核心思想**：让 AI 具备项目级记忆能力，能够记住创造者的判断、品味和责任感。

**实现方式**：
- 经验沉淀机制：自动捕获、评估、沉淀、治理
- 经验索引和匹配：主动提醒风险和提供指针
- 质量资产化：过程产物、实践经验自动沉淀

**设计原则**：
- 任何设计都应该有助于经验的沉淀和复用
- 应该让创造者的判断、取舍、拒绝都能被记录和复用
- 不应该依赖会话级上下文，而应该建立长期的知识资产

### 3. 称心如意 - 降低认知负担

**核心思想**：工具应该追求最好的体验，让创造者能够高效、舒适地使用 AI 辅助工作。

**实现方式**：
- 多入口设计：支持优秀开发者直接切入任意阶段
- 流程解耦：所有环节可跳过，按需执行
- 静默成功：遵循"没有消息就是好消息"的原则
- 最小高信号：仅输出关键信息，省略冗余输出

**设计原则**：
- 应该降低认知负担
- 应该提供友好的交互体验
- 应该让上下文"少而准"
- 应该让常用操作更便捷

### 4. 静默成功原则

**核心思想**：遵循 **Linux 命令行设计哲学**：**没有消息就是好消息**。节省用户时间，节省大模型 token。

**核心原则**：
1. **用户决策权不可侵犯**：所有需要用户判断的输出必须完整保留
2. **静默成功**：成功、无问题、无匹配时静默，不输出
3. **精简非决策输出**：减少非关键信息的冗余输出

**应用场景**：
- 经验索引静默：无匹配时完全静默，有匹配时仅输出关键信息
- 推进判据检查静默：判据满足时静默进入下一阶段
- 文件写入静默：写入成功时静默，失败时输出错误信息
- 阶段完成输出精简：正常完成时仅输出一行状态，有阻塞项时详细说明

**明确保留的输出**（用户决策权）：
- 审查报告：必须完整输出，用户需要根据完整报告自行判断
- 固定菜单选项：必须保留，用户需要完整的判断选项
- 候选展示：必须完整展示，用户需要了解足够的候选信息才能做出判断

### 5. 上下文组织原则

**核心思想**：让模型聚焦关键信息，提高输出质量。

**原则**：
- **先指针后细节**：先读取 INDEX.md（索引），再按需加载经验文件（细节）
- **最小高信号**：仅输出关键信息（风险级别 + 指针），省略冗长格式
- **分层加载**：先索引与概要，按需加载细节，避免 context rot

**应用场景**：
- 经验索引：先读取 INDEX.md，按需加载经验文件
- 文档引用：通过指针引用，而非复制内容
- 状态摘要：以 INDEX 为 SSoT，其他文件引用而非重复

### 6. 单一事实来源（SSoT）

**核心思想**：每个信息片段应该只在一个地方定义和维护。

**应用**：
- INDEX.md 是经验的单一事实来源，其他文件引用而非复制
- 经验索引作为经验的 SSoT，避免重复定义
- 质量资产（Experience 系统）作为项目规范的 SSoT

### 7. 关注点分离（SoC）

**核心思想**：将系统分解为不同的部分，每个部分负责一个特定的关注点。

**应用**：
- Skills 负责特定领域的任务（req、plan、build、review 等）
- Experience 系统负责质量资产（团队级标准/经验和项目级经验）
- Hooks 负责自动化流程
- Subagents 负责独立任务

### 8. 约定优于配置

**核心思想**：通过约定减少配置，提高开发效率。

**应用**：
- 文件命名约定（`001.req.<标题>.md`、`001.plan.<标题>.md`）
- 目录结构约定（`.cursor/.lingxi/requirements/`、`.cursor/skills/`）
- 索引格式约定（统一索引 `.cursor/.lingxi/memory/INDEX.md`）

## 参考

- **AI Native 设计原则**：`.cursor/.lingxi/memory/experience/ai-native-design.md`
- **静默成功原则**：`.cursor/.lingxi/memory/experience/references/workflow-optimization-silent-success.md`
- **核心价值指引**：`references/core-values.md`
