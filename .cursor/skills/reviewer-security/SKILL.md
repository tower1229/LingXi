---
name: reviewer-security
description: 安全审查专家，主动检查安全漏洞、注入风险、敏感信息暴露等。由 review-executor 显式调用，用于审查代码中的安全问题。
---

# Reviewer Security

## 本 Skill 会用到的能力

读 req 与变更代码；语义搜索安全相关实现（认证、输入处理、敏感信息等），识别漏洞与风险。

## Instructions

此 Skill 由 `review-executor` 显式调用，负责执行安全审查。可以访问 review-executor 的上下文，包括 req 文档、变更代码文件列表等。

### 1. 读取输入

从 review-executor 的上下文中获取：
- req 文档路径（了解安全相关需求）
- 变更代码文件列表
- 重点关注的安全相关代码片段（如用户输入处理、认证逻辑等）

### 2. 安全风险扫描

- **注入风险**：SQL 注入、命令注入、XSS 等
- **认证和授权**：密码存储、Token 管理、权限检查
- **敏感信息暴露**：密钥硬编码、敏感数据泄露、日志泄露
- **输入验证**：用户输入是否经过验证和清理
- **文件操作**：文件上传/下载的安全性、路径遍历风险
- **API 安全**：接口权限控制、请求频率限制、数据校验

### 3. 识别安全问题

- 安全漏洞（Blockers/High）
- 安全风险（Medium/Low）
- 最佳实践建议

### 4. 输出审查结果

- 安全问题清单（按优先级分级）
- 具体问题描述和代码位置
- 风险评估和建议修复方案

### 5. 输出与静默

遵循 [workflow-output-principles](.cursor/skills/about-lingxi/references/workflow-output-principles.md)；不干扰主流程，返回结构化审查结果。

### 6. 降级处理

- **代码无法读取**：
  - 标记为需要手动审查
  - 输出安全审查清单（基于 req 文档中的安全要求）
  - 提供常见安全问题检查项
- **扫描工具不可用**：
  - 基于代码模式识别常见安全问题
  - 输出潜在风险提示和代码位置
