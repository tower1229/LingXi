---
name: write-doc
description: 此 Skill 用于编写/修改项目文档，确保文档的语言风格和文字审美取向一致。当用户需要创建新文档、修改现有文档、或需要确保文档风格一致性时激活。
---

# Write Doc

## Overview

此 Skill 帮助编写和修改项目文档，确保文档的语言风格和文字审美取向与项目风格保持一致。**自动引用 style-fusion 产出的风格画像进行模仿**。通过参考结构化的写作风格指导，确保文档风格的一致性。

## 工作流程

### 1. 理解任务

在开始编写/修改文档前，明确：

- **文档类型**：README、技术文档、使用指南、API 文档等
- **目标受众**：用户、维护者、开发者等
- **文档目的**：介绍项目、使用指南、技术细节等
- **现有内容**：是否需要修改现有文档，还是创建新文档

### 2. 加载风格画像

在编写前，必须读取 style-fusion 的风格画像（`.cursor/.lingxi/context/style-fusion/profile.json`）：

1. **检查风格画像是否存在**：如果存在且 `sample_count > 0`，则使用风格画像
2. **调用 style-fusion 引擎**：使用 `scripts/style-fusion-engine.js` 的 `getProfile()` 函数获取风格画像
3. **转换为写作指导**：将风格向量转换为具体的写作指导（见下方"风格画像转换规则"）

**注意**：
- 如果风格画像不存在或 `sample_count === 0`，提示用户先使用 style-fusion 分析项目文档生成风格画像
- 风格指导专注于语言风格和审美取向，不限制文档结构或内容组织方式

### 3. 分析现有文档（如适用）

如果修改现有文档，先分析：

- 当前文档的语言风格
- 与风格指南的差异
- 需要改进的地方（语言表达、格式、可读性）
- 需要保留的内容和结构

### 4. 编写/修改文档

按照风格指南编写或修改文档，重点关注：

#### 4.1 语言风格

- **简洁表达**：使用短句，直接表达核心内容
- **专业而温暖**：保持专业但不失亲和力
- **实用导向**：提供具体示例和使用方法

#### 4.2 视觉呈现

- **格式规范**：使用加粗、代码块、表格、列表等增强可读性
- **层次分明**：使用清晰的标题层级和适当的空行
- **易于扫描**：使用格式工具让内容易于快速浏览

#### 4.3 文字审美

- **精炼原则**：避免冗余，保持简洁有力
- **专业准确**：使用准确的技术术语，但不过度专业化
- **可读性**：信息密度适中，易于理解

### 5. 风格检查

完成编写后，使用检查清单验证：

- [ ] 语言是否简洁有力（短句、直接表达）
- [ ] 是否使用了适当的格式工具（加粗、代码块、表格等）
- [ ] 是否提供了具体示例（如适用）
- [ ] 是否易于扫描和理解
- [ ] 是否避免了冗余和重复
- [ ] 表达是否专业而温暖（不过度技术化）

### 6. 输出文档

- 直接写入目标文件
- 遵循"静默成功"原则：写入成功不输出确认信息，失败才输出错误

## 使用场景

### 场景 1：创建新文档

用户："帮我写一个 API 文档" 或 "创建一个使用指南"

**流程**：

1. 明确文档类型和目标受众
2. 根据文档类型和目标设计文档结构（不受风格指南限制）
3. 加载风格画像：读取 style-fusion 风格画像（`.cursor/.lingxi/context/style-fusion/profile.json`）
4. 将风格画像转换为写作指导
5. 按照风格指导编写内容（语言风格、格式、可读性）
6. 进行风格检查
7. 输出文档

### 场景 2：修改现有文档

用户："优化这个 README" 或 "改进文档的可读性"

**流程**：

1. 读取现有文档
2. 加载风格画像：读取 style-fusion 风格画像（`.cursor/.lingxi/context/style-fusion/profile.json`）
3. 将风格画像转换为写作指导
4. 分析现有文档的语言风格与风格指导的差异
5. 保留现有结构和内容，按风格指导优化语言表达和格式
6. 进行风格检查
7. 输出修改后的文档

### 场景 3：确保风格一致性

用户："检查这些文档的风格是否一致" 或 "让文档风格与 README 保持一致"

**流程**：

1. 读取目标文档
2. 加载风格画像：读取 style-fusion 风格画像（`.cursor/.lingxi/context/style-fusion/profile.json`）
3. 将风格画像转换为写作指导
4. 对比分析语言风格和审美取向的差异
5. 提出改进建议或直接修改（只修改风格，不改变结构）
6. 输出结果

## 风格画像转换规则

当使用 style-fusion 的风格画像时，需要将风格向量转换为具体的写作指导：

### 句式长度分布 (sentence_length)

**量化指导**：
- 短句为主（short > 0.5）：每 10 句话中，≥ 5 句短句（≤ 15 字）
- 中句为主（medium > 0.5）：每 10 句话中，≥ 5 句中句（16-30 字）
- 长句为主（long > 0.5）：每 10 句话中，≥ 5 句长句（> 30 字）
- 混合使用：根据比例分配（如 short:0.3, medium:0.6, long:0.1 → 每 10 句：3 短、6 中、1 长）

**控制方法**：
1. 写作时每写完 3 句短句，写 6 句中句，再写 1 句长句
2. 使用短句表达要点，中句展开说明，长句处理复杂概念
3. 每段结束时检查句子长度分布

**检查清单**：
- [ ] 每 10 句话的句子长度分布是否符合比例？
- [ ] 短句是否用于强调要点？
- [ ] 长句是否用于复杂概念？

### 逻辑模式 (logic_pattern)

**量化指导**：
- 演绎推理为主（deductive > 0.5）：每 10 个段落中，≥ 5 段采用"观点-展开"结构
- 归纳推理为主（inductive > 0.5）：每 10 个段落中，≥ 5 段采用"举例-总结"结构
- 对比分析为主（contrast > 0.5）：每 10 个段落中，≥ 5 段使用对比手法
- 叙事性为主（narrative > 0.5）：每 10 个段落中，≥ 5 段按时间/事件顺序组织

**控制方法**：
1. 根据比例分配段落结构（如 deductive:0.7 → 70% 段落先提出观点再展开）
2. 演绎推理：每段开头先写结论句，再展开说明
3. 归纳推理：先写 2-3 个例子，再总结观点
4. 对比分析：使用"然而"、"相比之下"等连接词
5. 叙事性：使用"首先"、"然后"、"最后"等时间标记

**检查清单**：
- [ ] 段落结构是否符合逻辑模式分布？
- [ ] 演绎推理段落是否先提出观点？
- [ ] 归纳推理段落是否先举例后总结？

### 情感强度 (emotion_intensity)

**量化指导**：
- 低情感（< 0.3）：每 100 字中，情感词汇 ≤ 2 个，避免感叹号
- 中等情感（0.3 - 0.7）：每 100 字中，情感词汇 2-5 个，适度使用感叹号
- 高情感（> 0.7）：每 100 字中，情感词汇 ≥ 5 个，可以使用感叹号

**控制方法**：
1. 低情感：使用中性词汇，避免"非常"、"极其"等强化词
2. 中等情感：适度使用"重要"、"值得注意"等情感词汇
3. 高情感：可以使用"强烈"、"显著"等强化词，适度使用感叹号
4. 检查每段的情感词汇密度

**检查清单**：
- [ ] 情感词汇密度是否符合目标范围？
- [ ] 是否避免了过度情感化表达（低情感时）？
- [ ] 是否适度表达了情感（中等情感时）？

### 词汇水平 (vocabulary_level)

**量化指导**：
- casual：每 100 字中，专业术语 ≤ 1 个
- professional：每 100 字中，专业术语 1-3 个
- academic：每 100 字中，专业术语 ≥ 3 个

**控制方法**：
1. casual：使用日常用语，避免专业术语，必要时提供解释
2. professional：使用专业术语但提供简短解释，平衡易懂和专业
3. academic：可以使用密集术语，但确保上下文清晰
4. 首次使用术语时提供定义或解释

**检查清单**：
- [ ] 专业术语密度是否符合目标水平？
- [ ] 首次使用的术语是否提供了解释？
- [ ] 词汇选择是否平衡了易懂和专业？

### 结构偏好 (structure_preference)

**量化指导**：
- linear：每 10 个段落中，≥ 8 段按顺序展开，不使用嵌套列表
- hierarchical：每 10 个段落中，≥ 5 段使用标题、列表、分段
- nested：每 10 个段落中，≥ 5 段使用多层级嵌套结构

**控制方法**：
1. linear：按时间或逻辑顺序组织，避免复杂嵌套
2. hierarchical：使用清晰的标题层级（H1, H2, H3），配合列表和分段
3. nested：使用多层级列表（-、  -、    -），嵌套说明和子项
4. 每 3-5 个段落检查结构一致性

**检查清单**：
- [ ] 文档结构是否符合偏好类型？
- [ ] 标题层级是否清晰？
- [ ] 列表和分段是否适当使用？

### 开头风格 (opening_style)

**量化指导**：
- question：以问题开头的段落占比 ≥ 50%
- statement：以陈述句开头的段落占比 ≥ 50%
- context：以背景/上下文开头的段落占比 ≥ 50%
- direct：直接切入主题的段落占比 ≥ 50%

**控制方法**：
1. question：每段开头使用疑问句（"如何...？"、"什么是...？"）
2. statement：每段开头使用陈述句直接表达观点
3. context：每段开头先提供背景信息（"在...中"、"当...时"）
4. direct：每段开头直接切入主题，避免铺垫

**检查清单**：
- [ ] 段落开头是否符合目标风格？
- [ ] 开头是否清晰明确？
- [ ] 是否避免了不必要的铺垫（direct 风格时）？

### 结尾风格 (closing_style)

**量化指导**：
- summary：以总结结尾的段落占比 ≥ 50%
- reflection：以反思/展望结尾的段落占比 ≥ 50%
- call_to_action：以行动号召结尾的段落占比 ≥ 50%
- open：以开放式结尾的段落占比 ≥ 50%

**控制方法**：
1. summary：每段结尾总结要点（"总之"、"综上所述"）
2. reflection：每段结尾提出思考或展望（"值得思考的是"、"未来可以"）
3. call_to_action：每段结尾提出行动建议（"建议"、"应该"）
4. open：每段结尾留下开放性问题或思考空间

**检查清单**：
- [ ] 段落结尾是否符合目标风格？
- [ ] 结尾是否有力且符合目标？
- [ ] 是否避免了过于封闭的结论（open 风格时）？

### 语气和语调 (tone_and_voice)

**正式程度 (formality)**：
- 低正式（< 0.3）：使用口语化表达，如"可以"、"需要"，避免书面语
- 中等正式（0.3-0.7）：使用专业但易懂的表达，平衡口语和书面语
- 高正式（> 0.7）：使用书面化表达，避免口语化，使用"应当"、"需"等

**人称使用 (person_usage)**：
- 第一人称为主（first_person > 0.4）：使用"我"、"我们"表达，每 10 句话中 ≥ 4 句使用第一人称
- 第二人称为主（second_person > 0.4）：使用"你"、"您"直接对话，每 10 句话中 ≥ 4 句使用第二人称
- 第三人称为主（third_person > 0.4）：使用"他"、"它"客观描述，每 10 句话中 ≥ 4 句使用第三人称
- 中性表达为主（neutral > 0.4）：避免人称，使用"可以"、"需要"等，每 10 句话中 ≥ 4 句使用中性表达

**语态偏好 (voice_preference)**：
- active：使用主动语态（"我们实现了功能"），主动语态占比 ≥ 70%
- passive：使用被动语态（"功能被实现"），被动语态占比 ≥ 70%
- mixed：根据语境选择，主动和被动语态各占 40-60%

**控制方法**：
1. 根据正式程度选择词汇（口语化 vs 书面化）
2. 根据人称使用比例调整表达方式（每 10 句话按比例分配人称）
3. 优先使用主动语态，必要时使用被动语态（active 时）
4. 每写完一段检查正式程度、人称使用和语态

**检查清单**：
- [ ] 正式程度是否符合目标？
- [ ] 人称使用是否符合比例？
- [ ] 是否优先使用主动语态（active 时）？

### 信息密度 (information_density)

**信息密度 (density_level)**：
- 低密度（< 0.3）：每 100 字中，核心信息点 ≤ 2 个，留白较多
- 中等密度（0.3-0.7）：每 100 字中，核心信息点 2-4 个，信息适中
- 高密度（> 0.7）：每 100 字中，核心信息点 ≥ 4 个，信息密集

**详细程度 (detail_level)**：
- overview：提供总体框架，每 100 字中细节描述 ≤ 1 处
- moderate：平衡概述和细节，每 100 字中细节描述 1-2 处
- detailed：提供具体细节和示例，每 100 字中细节描述 2-3 处
- comprehensive：覆盖所有方面，每 100 字中细节描述 ≥ 3 处

**控制方法**：
1. 根据密度级别控制每段的信息点数量
2. overview：只写要点，不展开细节
3. moderate：要点 + 1-2 个关键细节
4. detailed：要点 + 多个细节 + 示例
5. comprehensive：要点 + 所有细节 + 示例 + 说明
6. 每写完一段检查信息密度和详细程度

**检查清单**：
- [ ] 信息密度是否符合目标级别？
- [ ] 详细程度是否符合目标？
- [ ] 是否避免了信息过载（低密度时）或信息不足（高密度时）？

### 交互性 (interactivity)

**交互风格 (interaction_style)**：
- question 为主（question > 0.4）：每 10 句话中，≥ 4 句使用问题引导
- directive 为主（directive > 0.4）：每 10 句话中，≥ 4 句使用指令式表达
- narrative 为主（narrative > 0.4）：每 10 句话中，≥ 4 句采用叙事性描述
- dialogue 为主（dialogue > 0.4）：每 10 句话中，≥ 4 句采用对话式表达

**支持元素 (supporting_elements)**：
- examples 为主（examples > 0.4）：每 10 个段落中，≥ 4 段包含示例
- code 为主（code > 0.4）：每 10 个段落中，≥ 4 段包含代码片段
- diagrams 为主（diagrams > 0.4）：每 10 个段落中，≥ 4 段包含图表
- none 为主（none > 0.4）：每 10 个段落中，≥ 4 段不使用额外支持元素

**控制方法**：
1. 根据交互风格比例分配句子类型（每 10 句话按比例分配）
2. question：使用"如何...？"、"什么是...？"等问题
3. directive：使用"请"、"应该"、"必须"等指令词
4. narrative：使用"首先"、"然后"、"最后"等叙事标记
5. dialogue：使用"你可以"、"我们来看看"等对话式表达
6. 根据支持元素比例添加示例、代码、图表（每 10 段按比例分配）
7. 每写完一段检查交互风格和支持元素

**检查清单**：
- [ ] 交互风格是否符合比例？
- [ ] 支持元素是否符合比例？
- [ ] 是否适当使用了问题、指令、叙事、对话等表达方式？

### 转换示例

假设风格画像为：
```json
{
  "sentence_length": { "short": 0.3, "medium": 0.6, "long": 0.1 },
  "logic_pattern": { "deductive": 0.7, "inductive": 0.1, "contrast": 0.1, "narrative": 0.1 },
  "emotion_intensity": 0.18,
  "vocabulary_level": "professional",
  "structure_preference": "hierarchical",
  "opening_style": "direct",
  "closing_style": "open",
  "tone_and_voice": {
    "formality": 0.6,
    "person_usage": { "first_person": 0.3, "second_person": 0.2, "third_person": 0.3, "neutral": 0.2 },
    "voice_preference": "active"
  },
  "information_density": {
    "density_level": 0.65,
    "detail_level": "moderate"
  },
  "interactivity": {
    "interaction_style": { "question": 0.2, "directive": 0.4, "narrative": 0.3, "dialogue": 0.1 },
    "supporting_elements": { "examples": 0.4, "code": 0.3, "diagrams": 0.2, "none": 0.1 }
  }
}
```

转换为写作指导：
```
**句式特征**：中句为主（60%），短句为辅（30%），长句较少（10%）
- 每 10 句话：3 短、6 中、1 长
- 使用短句表达要点，中句展开说明，长句处理复杂概念

**思维方式**：演绎推理为主（70%），先提出观点再展开说明
- 每 10 个段落中，≥ 7 段采用"观点-展开"结构
- 每段开头先写结论句，再展开说明

**情感表达**：情感强度低（0.18），保持理性、克制，客观表达
- 每 100 字中，情感词汇 ≤ 2 个，避免感叹号
- 使用中性词汇，避免"非常"、"极其"等强化词

**词汇水平**：专业术语适中，平衡易懂和专业
- 每 100 字中，专业术语 1-3 个
- 首次使用术语时提供简短解释

**结构偏好**：层次结构，使用标题、分段、列表等
- 每 10 个段落中，≥ 5 段使用标题、列表、分段
- 使用清晰的标题层级（H1, H2, H3）

**开头风格**：直接切入主题
- 每段开头直接切入主题，避免铺垫

**结尾风格**：开放式结尾，留下思考
- 每段结尾留下开放性问题或思考空间

**语气和语调**：中等正式（0.6），第一人称和第三人称混合使用（各 30%），主动语态为主
- 使用专业但易懂的表达，平衡口语和书面语
- 每 10 句话：3 句第一人称、2 句第二人称、3 句第三人称、2 句中性表达
- 主动语态占比 ≥ 70%

**信息密度**：中等密度（0.65），中等详细程度
- 每 100 字中，核心信息点 2-4 个
- 要点 + 1-2 个关键细节

**交互性**：指令式为主（40%），叙事性为辅（30%），示例和代码支持为主
- 每 10 句话：2 句问题、4 句指令、3 句叙事、1 句对话
- 每 10 个段落中，≥ 4 段包含示例，≥ 3 段包含代码片段
```

## 风格画像来源

风格画像由 style-fusion skill 自动生成和维护，存储在 `.cursor/.lingxi/context/style-fusion/profile.json`。

如果风格画像不存在，建议先使用 style-fusion 分析项目文档（如 README.md）生成风格画像：

```
/style-fusion @README.md
```

## 技术实现

### 调用 style-fusion 引擎

在 Node.js 环境中，可以通过以下方式调用 style-fusion 引擎获取风格画像：

```javascript
const styleFusion = require('.cursor/skills/style-fusion/scripts/style-fusion-engine.js');

// 获取风格画像
const profileResult = styleFusion.getProfile();

if (profileResult.status === 'ok' && profileResult.payload.sample_count > 0) {
  const styleVector = profileResult.payload.style_vector;
  // 使用风格向量转换为写作指导
} else {
  // 风格画像不存在，提示用户先使用 style-fusion 生成风格画像
  throw new Error('风格画像不存在，请先使用 style-fusion 分析项目文档生成风格画像');
}
```

### 风格画像路径

风格画像存储在：`.cursor/.lingxi/context/style-fusion/profile.json`

如果文件不存在或 `sample_count === 0`，提示用户先使用 style-fusion 生成风格画像。

## 注意事项

1. **风格优先，结构灵活**：此 Skill 专注于语言风格和审美取向，不对文档结构、内容组织方式或具体内容做限制
2. **自动风格匹配**：优先使用 style-fusion 风格画像，确保文档风格与项目风格画像一致
3. **精炼原则**：避免冗余，保持简洁有力
4. **可读性**：使用格式工具增强可读性，但不要过度使用
5. **适度专业化**：在专业和易懂之间找到平衡
6. **静默成功**：文档写入成功时不输出确认信息
