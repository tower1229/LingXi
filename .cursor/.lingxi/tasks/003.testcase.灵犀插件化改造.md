# 003.testcase.灵犀插件化改造

| 属性     | 值                            |
| -------- | ----------------------------- |
| 关联需求 | 003.req.灵犀插件化改造.md     |
| 关联规划 | 003.plan.灵犀插件化改造.md    |
| 创建日期 | 2026-02-21                    |

---

## 1. 测试范围

### 1.1 覆盖的功能需求

| 需求编号 | 需求描述概要 | 测试用例编号 |
| -------- | ------------- | ------------ |
| F1       | 新增插件清单 .cursor-plugin/plugin.json | TC-001 |
| F2       | 插件化后 Hook 可正确执行 | TC-002 |
| F3       | 项目内 .cursor/.lingxi/ 由使用侧创建 | TC-003 |
| F4       | 删除自研安装程序 | TC-004 |
| F5       | README 安装与快速开始更新 | TC-005 |
| F6       | 提供 Logo 与清单可选字段 | TC-006 |
| F7       | 所有 Skills/Commands/Agents 具备完整 frontmatter | TC-007 |
| F8       | about-lingxi 与架构文档同步 | TC-008 |

### 1.2 不覆盖的范围

- 插件市场审核流程、多插件仓库（marketplace.json）、MCP 打包
- 现有 Skills/Commands 业务逻辑的自动化单元测试

---

## 2. 验收检查清单（对应 req §6）

- [ ] `.cursor-plugin/plugin.json` 存在且含 name、paths。（TC-001）
- [ ] 安装插件后，在空白项目中可执行 /req、/init 等命令。（TC-002）
- [ ] 未执行任何安装脚本时，/init 能创建完整 `.cursor/.lingxi/` 骨架。（TC-003）
- [ ] `install/` 下安装脚本已删除或明确废弃；README 安装章节为插件安装。（TC-004, TC-005）
- [ ] 本 req 附录中含建议的 plugin.json、Logo 生成 prompt、提交前检查清单。（见 req 文档）
- [ ] 所有 Skills、Commands、Agents 具备完整 frontmatter。（TC-007）
- [ ] about-lingxi 与 README 中安装/开箱即用表述已更新。（TC-005, TC-008）

---

## 3. 手工/集成测试用例

### TC-001: 插件清单存在且可识别

**前置条件**：仓库已包含本次改造提交。

**测试步骤**：

1. 打开仓库根目录，确认存在 `.cursor-plugin/plugin.json`。
2. 打开该文件，确认包含 `name`（如 `lingxi`）、`commands`、`skills`、`agents`、`hooks` 路径，且路径为相对路径（如 `.cursor/commands`）。

**预期结果**：文件存在；字段完整；路径有效、无 `..` 或绝对路径。

---

### TC-002: 安装插件后命令可用且 Hook 可执行

**前置条件**：灵犀已作为 Cursor 插件安装到本机；准备一个**空白项目**（无或清空 `.cursor`）。

**测试步骤**：

1. 在 Cursor 中打开该空白项目。
2. 确认灵犀插件已启用。
3. 在聊天中输入 `/req`、`/init`、`/plan`、`/build`、`/review`、`/remember` 等，确认命令可被识别/补全并执行（至少执行 `/init` 一次以验证）。
4. 新开一个会话，确认 sessionStart 约定被注入（若项目内已有 `.cursor/.lingxi/`，可查看会话开始时是否有记忆检索等行为或约定说明）。

**预期结果**：/req、/init、/plan、/build、/review、/remember 等命令可用；新会话开始时 sessionStart 约定生效（若 Cursor 以工作区根解析 hook，则需项目内存在 .cursor；插件形态下由 Cursor 提供）。

---

### TC-003: /init 创建完整 .cursor/.lingxi/ 骨架

**前置条件**：灵犀已作为插件安装；打开一个**未运行过任何安装脚本**的空白项目（无 `.cursor/.lingxi/` 或仅有空的 .cursor）。

**测试步骤**：

1. 在该项目中执行 `/init`（可只做到 Step 0 或选类型后不写入记忆）。
2. 检查项目根下是否出现 `.cursor/.lingxi/` 及子目录：`tasks`、`memory`、`memory/notes`、`memory/notes/share`、`memory/references`、`workspace`。
3. 检查是否存在 `.cursor/.lingxi/memory/references/memory-note-template.md` 与 `.cursor/.lingxi/memory/INDEX.md`，且内容为模板与索引表头。

**预期结果**：目录结构完整；模板文件与 INDEX 占位内容正确。

---

### TC-004: 安装脚本已删除或废弃

**前置条件**：仓库为改造后状态。

**测试步骤**：

1. 确认 `install/bash.sh`、`install/powershell.ps1`、`install/install-manifest.json`、`install/test-install.sh` 已不存在。
2. 若存在 `install/README.md`，打开确认内容为「已废弃，请使用 Cursor 插件安装」或等效说明。

**预期结果**：无脚本可被误用；install 目录无 curl/irm 安装指引。

---

### TC-005: README 安装与快速开始

**前置条件**：仓库为改造后状态。

**测试步骤**：

1. 打开根目录 `README.md`。
2. 确认「安装」章节为从 Cursor 插件市场安装，无 `curl`/`irm` 一键安装。
3. 确认「快速开始」保留命令表，且包含「首次建议运行 /init 初始化项目」或等效说明。

**预期结果**：与 G4/S4 一致。

---

### TC-006: Logo 与 plugin.json logo 字段

**前置条件**：仓库为改造后状态。

**测试步骤**：

1. 确认存在 `assets/logo.svg`（或等价）。
2. 打开 `.cursor-plugin/plugin.json`，确认包含 `"logo": "assets/logo.svg"`（或等价路径）。

**预期结果**：Logo 文件存在；plugin.json 中 logo 路径正确，提交前检查可通过。

---

### TC-007: Skills、Commands、Agents 具备完整 frontmatter

**前置条件**：仓库为改造后状态。

**测试步骤**：

1. 扫描 `.cursor/commands/*.md`、`.cursor/skills/**/SKILL.md`、`.cursor/agents/*.md`。
2. 确认每个文件 frontmatter 中含 `name`、`description`（或等效必填项）。

**预期结果**：清单校验无 frontmatter 缺失。

---

### TC-008: about-lingxi 与架构文档同步

**前置条件**：仓库为改造后状态。

**测试步骤**：

1. 打开 `.cursor/skills/about-lingxi/references/architecture.md`、`core-values.md` 及 README。
2. 确认其中「安装」「开箱即用」表述为插件安装（从 Cursor 插件市场安装、/init 初始化等），无与脚本安装矛盾的描述。

**预期结果**：文档一致、无矛盾。

---

## 4. 成功标准对照（S1–S5）

| 标准 | 验证方式 | 对应用例 |
| ---- | -------- | -------- |
| S1   | 存在 `.cursor-plugin/plugin.json`，且含 name、skills/commands/agents/hooks 路径 | 查看清单文件 | TC-001 |
| S2   | 安装插件后，在任意项目中可使用 /req、/init 等命令 | 新工作区安装插件后执行命令 | TC-002 |
| S3   | 未运行安装脚本时，运行 /init 可在项目内创建 .cursor/.lingxi/ 骨架 | 空项目安装插件 → 仅执行 /init → 检查目录与模板 | TC-003 |
| S4   | README 安装章节改为插件安装说明，无 curl/irm 一键安装 | 查看 README | TC-005 |
| S5   | 任务文档或附录中包含建议的 plugin.json、Logo 生成 prompt、提交前检查清单 | 查看本 req 文档与附录 | req §7 |
