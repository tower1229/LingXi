# 006.task.灵犀优化建议整理

| 属性     | 值         |
| -------- | ---------- |
| 版本     | 1.0        |
| 创建日期 | 2025-02-23 |
| 需求类型 | 简单功能   |
| 复杂度   | 简单       |

---

## 1. 概述

### 1.1 背景

- 基于 Cursor 官方课程学习，已在对话中提出多条约灵犀优化措施与改进建议，对应课程要点包括：先探索再修改、可验证目标、防需求膨胀、从计划重来、半静默可验证性、上下文与对话管理、子代理与 token 选型。
- 这些建议需沉淀为正式任务文档，便于后续按 plan/build 分步落地，并保持与灵犀架构、核心价值一致。

### 1.2 问题描述

- 建议目前仅存在于对话中，未形成结构化 req 文档，不便于排期、拆解与验收。
- 需要将每条建议转化为可执行的功能需求（实现方案 + 验收标准），并纳入统一任务编号与目录。

### 1.3 解决方案概述

- 在 `.cursor/.lingxi/tasks/` 下创建 **006.task.灵犀优化建议整理.md**，采用简单功能 req 模板。
- 将 7 条优化建议逐条列为**目标**与**功能需求**，每条对应关键文件/实现方式与可验证的验收标准；本 req 仅产出任务文档，不包含具体代码或文档改动实现。

---

## 2. 目标

| 编号 | 目标 | 优先级   |
| ---- | ---- | -------- |
| G1   | 产出包含全部 7 条优化建议的单一 req 任务文档 | 必须实现 |
| G2   | 每条建议在文档中有对应的功能需求行、实现方案与验收标准 | 必须实现 |

---

## 3. 功能需求

| 编号 | 需求描述 | 实现方案 | 验收标准 | 优先级   |
| ---- | -------- | -------- | -------- | -------- |
| F1   | **先探索再修改**：在实现前对不熟悉模块先做探索/理解，再改代码 | 在 `build-executor`（及可选 `plan-executor`）的 SKILL 中增加约定：对本次任务涉及的不熟悉模块/目录，先用语义搜索或读关键文件建立理解，再开始实现 | build-executor SKILL 中存在「先探索再修改」的步骤或原则描述；无硬编码规则，符合 AI Native | 必须实现 |
| F2   | **可验证目标与 review 闭环**：审查前优先执行测试/类型检查/lint；下一步建议中含「运行测试/类型检查」 | 在 `review-executor` SKILL 或 `workflow-output-principles` 中约定：有测试/类型检查/lint 时审查前优先执行或说明状态；下一步建议中增加「运行测试/类型检查」等可验证动作选项 | review 相关文档中体现「可验证目标」前置或下一步建议包含可验证动作 | 必须实现 |
| F3   | **防需求膨胀**：对复杂/跨模块需求提示「建议先 /plan 再 /build」 | 在 `req-executor` 或 `review-req-executor` 中增加范围/复杂度提示（自然语言描述）：当需求明显跨多模块/多文件时，在产出或审查建议中提示「建议先执行 /plan 拆解后再 /build」；req 文档或下一步建议中区分简单→直接 build、复杂→建议 plan | task/vet 相关描述或模板中存在「建议先 /plan」的引导 | 必须实现 |
| F4   | **从计划重来**：偏离时提供「撤销→修订 plan/req→重新 /build」的下一步选项 | 在 `workflow-output-principles` 的 /build、/review 的「下一步可尝试」中增加一项：若实现已偏离 task/plan，建议撤销更改→修订 plan 或 task→重新 /build | workflow-output-principles 中 /build 或 /review 的下一步建议包含「从计划重来」类选项 | 必须实现 |
| F5   | **半静默可靠性 + 可验证性**：高/低可靠性判定增加「可验证性」维度 | 在 `lingxi-memory` 或 `memory-system` 的可靠性判定指引中补充：用户原话近乎一字不差且可被后续检索/对话客观验证→倾向高可靠；需主观解释或易歧义→倾向低可靠；可写成自然语言规则或示例 | lingxi-memory 或 memory-system 文档中存在可验证性维度的判定说明 | 必须实现 |
| F6   | **对话与上下文使用建议**：新任务/犯错时新开对话；延续旧任务可引用历史对话 | 在 about-lingxi 的 references（如 `cursor-learn-courses-summary` 或 `memory-system`）或 README 中增加「对话与上下文建议」：切换新任务或 Agent 反复犯错时可新开对话；延续旧任务可引用旧对话（@chat 或自然语言）；记忆检索跨会话生效 | 文档中存在「对话与上下文」使用建议小节 | 必须实现 |
| F7   | **子代理 vs Skill 选型**：明确何时用子代理、何时用 Skill，控制 token | 在 `component-guides` 或 `cursor-learn-courses-summary` 的灵犀对照部分增加：子代理适合独立上下文、多步、需隔离的任务；可一次性完成的任务优先用 Skill；避免不必要子代理以控制 token | component-guides 或 cursor-learn 总结中存在子代理与 Skill 选型及成本说明 | 必须实现 |

---

## 4. 非目标

- 本 req 不包含对上述 7 条建议的具体实现（不改动 build-executor、review-executor、workflow-output-principles、lingxi-memory、memory-system、about-lingxi、component-guides 等文件内容），仅产出本任务文档。
- 具体落地由后续 `/plan 006`、`/build 006` 或分拆子任务执行。

---

## 5. 验收检查清单

- [ ] 存在 `.cursor/.lingxi/tasks/006.task.灵犀优化建议整理.md`。
- [ ] 文档包含概述（背景、问题描述、解决方案概述）、目标（G1/G2）、功能需求（F1–F7）、非目标、验收检查清单。
- [ ] F1–F7 每条均有需求描述、实现方案（关键文件/约定）、验收标准。
- [ ] 7 条建议与对话中提出的条目一一对应（先探索再修改、可验证目标与 review、防需求膨胀、从计划重来、半静默可验证性、对话与上下文建议、子代理 vs Skill 选型）。
