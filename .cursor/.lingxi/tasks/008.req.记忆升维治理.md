| 属性 | 值 |
| --- | --- |
| 版本 | 1.0 |
| 状态 | 草稿 |
| 创建日期 | 2026-02-24 |
| 需求类型 | 其他 |
| 复杂度 | 中等 |
| 特性标签 | 文档为主 |

---

## 1. 概述

### 1.1 背景

当前记忆系统已具备「每轮检索注入 + 双入口写入 + 近邻治理」能力，但在记忆质量维度仍存在一个核心缺口：新增条目常停留在对象级细节，缺少向可复用原则的主动升维机制。结果是条目虽正确，却难以在未来相似场景中持续发挥决策价值。

结合当前体系（`memory-note-template`、`lingxi-memory`、`memory-retrieve`、`remember`）与通用知识治理实践（Create-Curate-Retire 生命周期、可复用性门槛、时效治理），本任务需要为灵犀补齐「抽象层级治理」能力，保证记忆沉淀从“记录事实”升级为“指导未来决策”。

### 1.2 问题描述

本任务解决以下问题：

- 记忆条目出现「正确但低复用价值」现象：事实正确，但无法改变未来决策。
- 当前沉淀缺少统一的抽象判定标准：何时写细节、何时写原则、何时双层表达尚未制度化。
- 缺少生命周期治理：已失去复用价值的条目无法被系统降级、归档或合并。
- 触发机制与质量门槛未联动：写入可发生，但“是否值得写”缺少可执行评分卡。

### 1.3 解决方案概述（不含实现细节）

建立「记忆升维治理框架」并嵌入现有 workflow，核心由四层构成：

1. **问题定义层**：把低价值记忆定义为“真但无法显著提升未来决策质量”的条目。
2. **抽象建模层**：统一使用 L0（实例事实）/L1（可复用原则）双层结构，按场景选择单层或双层沉淀。
3. **质量门槛层**：引入可复用性评分卡（迁移性、触发性、可验证性、稳定性、决策增益）作为写入/升级/归档依据。
4. **生命周期层**：引入 Active/Local/Archive 状态流转与周期治理，抑制“正确废话”长期污染检索面。

---

## 2. 目标

| 编号 | 目标 | 优先级 |
| --- | --- | --- |
| G1 | 明确并固化“低价值记忆”定义，形成统一判定口径 | 必须实现 |
| G2 | 建立可执行的“细节→原则”升维流程，并接入记忆写入路径 | 必须实现 |
| G3 | 建立可量化质量门槛与验收标准，降低低复用条目写入率 | 必须实现 |
| G4 | 建立生命周期治理（合并/降级/归档），持续优化检索质量 | 高优先级 |

---

## 3. 非目标

- 本任务不改动代码执行框架或模型能力本身，只治理记忆规范与流程。
- 本任务不追求一次性清洗全部历史记忆，采用可回放、可渐进迁移策略。
- 本任务不引入重型知识图谱系统，优先保持当前轻量 notes + INDEX 架构。

---

## 4. 成功标准（必须可验证）

| 标准 | 描述 | 验证方式 |
| --- | --- | --- |
| S1 | 形成《记忆升维判定标准》，包含低价值定义、L0/L1 决策规则、例外条件 | 文档审查（`/review-req`） |
| S2 | 形成《写入评分卡》并在 remember/auto 场景有明确使用位置 | 场景 walkthrough（至少 3 个样例） |
| S3 | 形成《生命周期治理规则》，含触发条件、状态迁移、治理节奏 | 文档审查 + 手工演练 |
| S4 | 至少给出 5 条现有记忆的升维改写示例（含 MEM-006） | 样例对比检查 |
| S5 | 下一轮检索提示中，原则层记忆命中率高于纯细节层（定性） | 对话回放对比（同类问题） |

---

## 5. 用户故事

### US-1：作为 workflow 设计者，我希望记忆沉淀能优先产出可复用原则，以便后续同类问题无需重复纠偏

**作为** 维护灵犀记忆系统的设计者  
**我想要** 在记忆写入时自动判断抽象层级并给出升维建议  
**以便** 记忆库长期保留高价值决策能力，而非积累一次性正确描述

**验收标准：**

- [ ] 给定一条对象级细节记忆，可产出对应原则级表达
- [ ] 给定一条历史已失效细节记忆，可判定为归档或并入上位原则
- [ ] 给定一条高争议记忆，可通过门控避免误写入

---

## 6. 功能需求

| 编号 | 需求描述 | 实现方案 | 验收标准 | 优先级 |
| --- | --- | --- | --- | --- |
| F1 | 定义“低价值记忆”与“升维记忆”的统一判定口径 | 在记忆规范文档中新增术语定义与反例边界，明确“真但低决策增益”判定 | 能对至少 10 条样例给出一致判定 | 必须实现 |
| F2 | 建立 L0/L1 双层沉淀模板 | 在模板中增加“实例事实层 + 原则层”结构说明与适用条件 | MEM-006 可完成双层改写并通过审查 | 必须实现 |
| F3 | 建立写入评分卡并接入 remember/auto 说明 | 在 remember、lingxi-memory、memory-system 文档中统一评分卡字段与阈值语义 | 任一写入样例可按评分卡给出写/不写结论 | 必须实现 |
| F4 | 建立生命周期治理规则 | 增加 Active/Local/Archive 状态定义、触发条件、治理频率与回退策略 | 有明确巡检流程，能处理“正确废话”条目 | 高优先级 |
| F5 | 提供存量迁移策略与样例集 | 给出分批治理方案（优先高频/高冲突条目）与最小改写样例库 | 可执行迁移清单输出完整 | 高优先级 |

---

## 7. 变更范围（文档为主）

### 7.1 主要影响对象

- 记忆规范与模板：
  - `.cursor/.lingxi/memory/references/memory-note-template.md`
  - `.cursor/skills/about-lingxi/references/memory-system.md`
- 记忆写入入口与治理说明：
  - `.cursor/agents/lingxi-memory.md`
  - `.cursor/commands/remember.md`
- 工作流解释层（必要时同步）：
  - `.cursor/skills/about-lingxi/references/component-guides.md`
  - `.cursor/commands/init.md`（如涉及初始化记忆准则，init 流程已迁至 command）

### 7.2 非侵入范围

- 不改动现有命令名称与入口形态（`/remember`、`/req`、`/init`）。
- 不改动当前 notes + INDEX 物理存储结构。
- 不要求新增外部依赖。

---

## 8. 关键决策与方案对比

| 决策点 | 方案 A | 方案 B | 推荐 |
| --- | --- | --- | --- |
| 抽象策略 | 仅写原则，放弃细节 | L0/L1 双层并存，按需精简 | B |
| 质量门槛 | 人工主观判断 | 评分卡 + 阈值 + 人工门控 | B |
| 生命周期 | 永久 active | Active/Local/Archive 流转 | B |
| 存量处理 | 一次性重写 | 分批治理（高频优先） | B |

推荐理由：

- 仅写原则会丢失可验证证据；仅写细节会失去迁移能力。双层最稳妥。
- 纯主观判断不稳定，评分卡能提高一致性并降低争议。
- 生命周期治理是避免“正确废话”累积的必要机制。

---

## 9. 风险与对策

| 风险 | 影响 | 对策 |
| --- | --- | --- |
| 过度抽象导致可执行性下降 | 注入后无法指导具体行动 | 保留 L0 证据层，L1 必须附可执行 one-liner |
| 评分卡过重增加写入成本 | 写入效率下降，用户抵触 | 采用 5 维轻量评分，允许快速默认值 |
| 存量改写引入语义偏差 | 历史经验被误改 | 分批 + 审查 + 可回滚（保留 supersedes） |
| 生命周期误判导致有用知识被归档 | 检索召回降低 | 归档可恢复，先降级后删除 |

---

## 10. 验收检查清单

- [ ] 问题定义：已明确“低价值记忆”判定标准与边界反例
- [ ] 升维机制：已形成 L0/L1 模型与转化模板
- [ ] 评分卡：已定义维度、阈值、使用位置、输出格式
- [ ] 生命周期：已定义状态、迁移条件、治理节奏、回退
- [ ] 存量迁移：已提供 MEM-006 在内的样例改写与批量策略
- [ ] 一致性：相关文档间术语一致、无互相冲突约定

---

## 11. 附录（调研要点）

### 11.1 外部实践摘录（用于方向校准）

- 知识治理普遍采用 Create-Curate-Retire 生命周期，强调“创建后必须持续治理与退役”。
- 高质量知识条目应优先抽象规则与约束，而非绑定单一实例细节。
- 时间衰减与使用频率可作为条目优先级管理信号，降低陈旧知识污染。

### 11.2 与现有记忆约定的对齐点

- 与现有模板“记录可复用品味与约定、避免一次性细节”一致，需要从原则补充提升到流程硬约束。
- 与现有记忆系统“写入为提取服务”一致，本任务将该原则量化为可执行门槛。
- 对 MEM-006 这类条目，需从对象级描述升维到可迁移的表达规范原则。

---

## 12. 记忆质量评分卡（可直接套用）

### 12.1 使用目的

在每次沉淀时，用统一的 5 维评分卡（每维 0-2 分）快速判断应采用哪种写入方式：

- 写事实（L0）
- 写原则（L1）
- 两者都写（L0 + L1）
- 不写

### 12.2 五维评分定义（每维 0-2 分）

| 维度 | 0 分 | 1 分 | 2 分 |
| --- | --- | --- | --- |
| D1 决策增益（Decision Gain） | 仅复述事实，几乎不影响未来决策 | 对局部决策有帮助 | 能显著影响未来同类决策 |
| D2 迁移性（Transferability） | 仅适用于单对象/单文件/单次问题 | 可迁移到同类场景 | 可迁移到跨场景或跨模块 |
| D3 触发性（Triggerability） | 未来难以被检索命中 | 有明确触发词但较窄 | 多种表达均可稳定命中 |
| D4 可验证性（Verifiability） | 纯主观判断、难复核 | 可部分复核 | 可通过文本/行为/结果客观复核 |
| D5 稳定性（Stability） | 高时效/一次性，易过期 | 阶段性有效 | 相对稳定，短期不易失效 |

> 总分 `T = D1 + D2 + D3 + D4 + D5`，范围 0-10。

### 12.3 自动判定规则（四类输出）

| 判定条件 | 动作 | 说明 |
| --- | --- | --- |
| `T <= 3` | 不写 | 低价值条目，避免“正确废话”入库 |
| `T in [4, 5]` 且 `D4 >= 1` | 写事实（L0） | 保留可验证证据，不强行抽象 |
| `T in [6, 7]` 且 `D1 + D2 >= 3` | 写原则（L1） | 已具复用价值，优先沉淀可执行原则 |
| `T >= 8` 且 `D2 >= 1` 且 `D4 >= 1` | 两者都写（L0 + L1） | 同时保留证据层与可迁移原则层 |

### 12.4 冲突与兜底规则

- 若 `D4 = 0`（不可验证），即使总分高也不能直接写 L1；降级为“不写”或“L0 待确认”。
- 若 `D5 = 0` 且问题已一次性解决，默认“不写”；除非 `D1 = 2` 且 `D2 >= 1`，可写 L1 的弱版本并标注适用边界。
- 若存在明显反例或冲突记忆，优先进入门控（merge/replace/veto），不走静默写入。

### 12.5 写入模板（执行时直接套用）

- **L0（事实层）一句话模板**：在 `[具体场景]` 下，发生了 `[可验证事实/操作]`，导致 `[结果]`。
- **L1（原则层）一句话模板**：在 `[场景族]` 中，优先 `[策略]`，避免 `[反策略]`，因为 `[目标函数/风险]`。

### 12.6 快速执行流程（4 步）

1. 对候选条目按 D1-D5 各打 0-2 分，得到总分 T。  
2. 套用 12.3 判定表，得到动作（不写/L0/L1/L0+L1）。  
3. 套用 12.5 模板生成 one-liner，并补充 signals/counter-signals。  
4. 若命中冲突条件，转门控；否则按当前写入约定执行。  

### 12.7 示例（MEM-006 升维）

- **L0 事实层**：引用某个 Skill 时，写完整路径会增加文档噪声与阅读负担。  
- **L1 原则层**：引用能力时优先自然语言短引用，避免暴露实现路径，以提升表达简洁度和可迁移性。  
