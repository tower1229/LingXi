---
name: req
description: 创建任务文档（产出：001.req.<标题>.md）
args:
  - name: description
    required: true
    description: 需求描述
---

# /req - 创建任务文档

## 命令用途

创建一个完整的"任务文档"，这是整个流程的核心。高质量的 req 文档是保证任务最终效果的前提。Req 必须超越普通 PRD 文档的范畴，除了需求提纯和放大之外，还必须定好核心技术方案或技术决策。这不是一份传统意义上产品经理向技术团队提出的需求说明，而是一个顶尖创造者脑海中迸发的集设计灵感、产品构思、实现途径于一体的任务文档。

## 使用方式

```
/req <需求描述>
```

**任务编号自动生成**：命令会自动扫描 `.cursor/.lingxi/tasks/` 目录，提取所有 `*.req.*.md` 文件的编号，取最大编号+1，从 001 开始。

**标题自动生成**：从需求描述中提取核心关键词作为标题，最多 10 个中文字符或 20 个英文字符，特殊字符自动替换为下划线。

## 产物

- `.cursor/.lingxi/tasks/001.req.<标题>.md`（任务文档）

**输出规则（静默成功原则 + 下一步建议）**：

- 文件写入成功：可不输出文件内容摘要，但**必须在当轮回复末尾**输出「**下一步可尝试（选一项）**」及 A/B/C/D 四项（格式与允许集合见 req-executor Skill）；用户可通过回复 A/B/C/D 快速选择下一动作。
- 文件写入失败：输出错误信息
- 若本步未写入任何 req 文档（如仅做了澄清未落盘）：可不包含下一步建议

## 执行逻辑

本命令将执行逻辑委托给 `req-executor` Skill。详细执行流程请参考 `req-executor` Skill 文档（`.cursor/skills/req-executor/SKILL.md`）。

## 记忆捕获

记忆写入由 **lingxi-memory** 子代理在独立上下文中执行；主对话在需要时通过**显式调用**（`/lingxi-memory mode=auto input=...` 或自然语言「使用 lingxi-memory 子代理将可沉淀内容写入记忆库」）交给子代理，本命令不包含捕获与写入逻辑。

**激活机制**：

- 任务完成或关键决策出现时，主 Agent 可使用**显式调用**：`/lingxi-memory mode=auto input=<本轮要点>` 或自然语言「使用 lingxi-memory 子代理将可沉淀内容写入记忆库」
- 候选在会话中展示，用户可选择沉淀

**触发场景**：当发生以下情况时，可**显式调用** lingxi-memory 子代理写入记忆：用户拒绝、纠正、排除（如不要/别用/改成…）时也识别并传入记忆候选。

- 需求固化、范围调整、优先级变更
- 目标纠正、方案选择、约束添加
- 边界明确、验收调整、风险确认

Subagent 定义见 `.cursor/agents/lingxi-memory.md`。
