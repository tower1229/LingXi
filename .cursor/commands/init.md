---
name: init
description: 引导式初始化项目（创建 .cursor/.lingxi/ 骨架与可选记忆草稿，用户门控写入）
args: []
---

# /init - 项目初始化命令

执行本命令时遵循 [workflow-output-principles](.cursor/skills/about-lingxi/references/workflow-output-principles.md) 中的输出与静默原则。

## 命令用途

初始化 workflow 到项目，建立项目上下文（技术栈、目录结构、关键模块、业务链路与约束）；文档齐全时优先从现有内容整理，仅对缺失项提问。生成一份**连续编号**的“记忆候选清单”（包含草稿项与可选候选项，默认不写入，需用户门控）。

---

## 使用方式

```
/init
```

命令无需参数。当项目已有较完整文档（如 README、架构说明、任务文档）时，agent 会**优先从现有内容中整理**项目目标、用户、关键流程、风险与发布方式，仅对无法推断或不确定的部分向你提问；你可直接确认或修正后进入候选清单与写入门控。新项目或文档较少时仍通过对话式引导收集。

## 执行逻辑

本命令将执行逻辑委托给 `init-executor` Skill。详细执行流程与收集清单见 `.cursor/skills/init-executor/SKILL.md` 及 `skills/init-executor/references/init-checklists.md`。

---

## 写入门控（关键规则）

> - 本命令会生成“记忆候选清单”，**默认不写入磁盘**。
> - 只有当你在 Q2 明确选择写入（`All` / `1,3`）时，才会落盘到 `.cursor/.lingxi/memory/notes/` 并更新 `.cursor/.lingxi/memory/INDEX.md`。
> - 你只回复 `A`（不含 `; ...`）时，等价于 `A; S`（默认跳过写入）。
> - 写入通过**显式调用** lingxi-memory 子代理完成（在提示中使用 `/lingxi-memory mode=remember input=...` 或自然语言提及「使用 lingxi-memory 子代理将选中的候选写入记忆库」），主对话不展示写入过程。

---

## 交互契约（同屏双问）

> 说明：具体“Agent 静默推断项目类型（A-H）→ 按类型收集清单 → 生成草稿 → 门控写入”的详细执行逻辑，见 `.cursor/skills/init-executor/SKILL.md` 与其依赖 `skills/init-executor/references/init-checklists.md`。类型不向用户展示、无需确认或修正。

```markdown
## 请确认并做两项选择（互不影响）

### Q1：下一步动作（必选）

- 🚀 **A) 信息准确，进入候选清单生成阶段**
- 📝 **B) 信息准确，但需要重点调查某个模块**（必须附模块名）
- ✅ **C) 信息准确，继续深入调查所有模块**
- 📋 **D) 信息需要补充或修正**（必须附补充/修正点）

### Q2：是否写入到记忆库（可选，默认跳过）

- ⏭️ **S) 跳过写入**（默认；只展示候选清单，不写入磁盘）
- ✅ **All) 写入候选清单的全部条目**
- 🔢 **1,3,5) 写入候选清单中选择编号的条目**（逗号分隔）

### 输入方式（推荐一行）

- `A; S`
- `B: <模块名>; All`
- `C; 1,3`
- `D: <补充/修正点>; S`

（也支持分两条消息：先回 Q1，再回 Q2）
```

**解析与追问规则**：

- Q1 必选；Q2 可选（缺省默认为 `S`）
- 用户只回复 `A` 等价 `A; S`
- 若用户只回答 Q2（如 `All`），只追问补齐 Q1（不重复贴大段内容）
- 若用户选择 `B` 但未提供模块名，只追问模块名；若选择 `D` 但未提供修正点，只追问修正点
