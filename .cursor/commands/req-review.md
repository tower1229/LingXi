---
name: req-review
description: 审查 req 文档（可选，可多次执行）
args:
  - name: taskId
    required: true
    description: 任务编号（如 001）
---

# /req-review - 审查 req 文档

## 命令用途

对 req 文档展开 review，用于辅助提升 req 文档的质量。该步骤可省略，也可以多次执行，完全取决于使用者。

**定位**：这是一个质量提升工具，不是强制环节。用户可以在任意时候使用此命令审查 req 文档，发现潜在问题并提出改进建议。

## 前置要求

- **Cursor Nightly**：本工作流依赖 Agent Skills（仅 Nightly 渠道可用）
- req 文档已存在：`.cursor/.lingxi/requirements/<taskId>.req.*.md`

## 使用方式

```
/req-review <taskId>
```

**示例**：

```
/req-review 001
```

命令会自动查找 `.cursor/.lingxi/requirements/001.req.*.md` 文件。

## 产物

**不产出文件**，仅输出审查结果和建议到对话中。

## 执行流程

### 1. 读取 req 文件

- 扫描 `.cursor/.lingxi/requirements/` 目录
- 查找 `<taskId>.req.*.md` 文件（如 `001.req.*.md`）
- 如果找不到文件，提示用户并提供解决方案

### 2. 多维度审查

按以下维度依次审查 req 文档：

#### 2.1 需求完整性

检查内容：

- **功能描述**：功能描述是否完整、清晰、无歧义？
- **边界清晰**：需求范围是否明确？边界是否清晰？
- **用户故事**：是否包含至少 1 条用户故事？
- **验收标准**：验收标准是否明确、可验证？
- **非目标**：是否明确列出"不做"的内容？（如适用）

**输出**：发现问题时，明确指出缺失或模糊的部分，并提供改进建议。

#### 2.2 技术可行性

检查内容：

- **技术选型**：技术选型是否可行？是否适合项目上下文？
- **架构设计**：架构思路是否合理？模块划分是否清晰？
- **技术难点**：是否识别了技术难点？（后端需求）
- **风险评估**：是否评估了技术风险？是否有缓解措施？（后端需求）
- **可行性结论**：可行性结论是否明确？（后端需求）

**输出**：发现问题时，指出潜在的技术风险或不可行性，并提供替代方案建议。

#### 2.3 可测试性

检查内容：

- **验收标准**：验收标准是否可验证？是否包含具体的测试/验证方式？
- **成功标准**：成功标准是否可测量？是否包含明确的验证方式？
- **功能需求**：功能需求是否可测试？是否定义了可验证的验收标准？
- **边界条件**：是否考虑了边界条件和异常场景？

**输出**：发现问题时，指出难以验证的部分，并提供如何使其可验证的建议。

#### 2.4 可实现性

检查内容：

- **实现方案**：功能需求表格中的"实现方案"是否提供了足够的指引？（关键文件、实现模式）
- **依赖明确**：外部依赖是否明确？集成方式是否清晰？（中等+复杂度）
- **API 规范**：API 规范是否完整？请求/响应格式是否定义清楚？（后端需求）
- **数据模型**：数据模型是否完整？字段含义和约束是否明确？（后端中等+）
- **文档同步**：是否识别了需要同步的文档？（中等+复杂度）

**输出**：发现问题时，指出缺失的关键信息，并提供补充建议。

### 3. 输出审查结果

**输出格式**：

```markdown
## Req 文档审查结果

### 总体评价

[3-6 行总结：文档质量如何，主要问题是什么，是否需要重大改进]

### 详细问题清单

#### 需求完整性

- [ ] 问题 1：...
  - **影响**：高/中/低
  - **建议**：...

- [ ] 问题 2：...

#### 技术可行性

- [ ] 问题 1：...
  - **影响**：高/中/低
  - **建议**：...

#### 可测试性

- [ ] 问题 1：...
  - **影响**：高/中/低
  - **建议**：...

#### 可实现性

- [ ] 问题 1：...
  - **影响**：高/中/低
  - **建议**：...

### 改进优先级

**必须修复**（Blockers）：
- 问题 X：...
- 问题 Y：...

**建议修复**（High）：
- 问题 A：...
- 问题 B：...

**可选优化**（Medium/Low）：
- 问题 C：...
```

### 4. 静默成功原则

- **无问题**：如果文档质量良好，无重大问题，静默输出简要总结即可
- **有问题**：发现问题时，详细列出问题清单和改进建议
- **不重复审查**：如果文档刚创建且用户未做修改，可以提示"文档质量良好"或静默通过

