# /review-req - Requirement 审查与风险评估

## 命令用途

审查 Requirement 的执行风险和不足之处，确保需求的可执行性和完整性。**在进入 Plan 阶段前，必须确保需求质量**。

**核心原则：**

- 风险识别优先：技术/业务/执行三维度
- 完整性检查：按需求类型（前端/后端/全栈）检查必要信息
- 可执行性验证：评估是否可直接指导开发
- 改进建议：提供具体、可操作的改进方案

**输出方式：**

- 审查结果直接输出到对话中，不保存文档文件
- 如果发现阻塞性问题（Blockers），建议用户先更新 Requirement，再进入 Plan

## 使用方式

```
/review-req <REQ-xxx>
```

示例：

```
/review-req REQ-001
```

---

## 执行流程

### 第一步：理解 Requirement 内容

- 识别需求类型和复杂度
- 理解功能需求、验收标准、依赖关系
- 查看 UI 交互规范、API 规范（如适用）

### 第二步：风险评估

**技术风险：**

- 技术可行性（初步判断，详细技术方案在 Plan 阶段）
- 架构风险（兼容性、现有系统影响）
- 依赖风险（外部依赖、版本兼容、技术依赖）- 在 Requirement 中描述为"依赖与集成"

**业务风险：**

- 需求明确性（目标清晰、标准可量化、用户故事完整）
- 边界情况（异常处理、错误处理、降级方案）
- 影响范围（现有功能影响、用户体验、数据迁移）

**执行风险：**

- 信息完整性（UI 规范、功能需求、依赖关系）- **注意**：API 规范、数据库变更在 Plan 阶段设计
- 可测试性（验收标准可测、测试场景明确）- 在 Requirement 中描述为"验收检查清单"
- 时间风险（复杂度评估、工作量估算）

### 第三步：需求完整性检查

**前端需求：**

- UI 交互规范（三态规则、状态流转、加载反馈）
- 用户旅程（入口、流程、反馈）
- 用户分析（目标用户、用户旅程）
- **注意**：API 字段需求在 Requirement 中描述为"数据需求"，但详细的 API 规范在 Plan 阶段设计

**后端需求：**

- 功能需求（功能描述、输入/输出、异常处理）
- 依赖与集成（依赖关系、现有系统分析、技术依赖）
- 业务逻辑边界（边界情况、错误处理、降级方案）
- **注意**：API 规范、数据模型、技术可行性在 Plan 阶段设计，Requirement 阶段不包含这些

**全栈需求：**

- 同时满足前后端检查项
- 前后端协作（数据流、状态同步、缓存更新）- 在 Requirement 中描述为"依赖与集成"
- 集成点（依赖 REQ 交互点、数据变更通知）- 在 Requirement 中描述为"PRD 依赖关系"

### 第四步：规范符合度检查

- 模板选择（是否按需求类型选择正确模板）
- 命名规范（API 端点、字段命名符合项目约定）
- 架构模式（符合项目架构规范）
- 类型安全（使用类型定义、避免 `any`）

### 第五步：输出审查结果

将审查报告直接输出到对话中，不保存为文件。

---

## 审查报告结构

```markdown
# Requirement 审查报告：<REQ-xxx>

## 1. 执行风险总结

- 技术风险（高/中/低）
- 业务风险（高/中/低）
- 执行风险（高/中/低）

## 2. 需求完整性分析

- 缺失信息清单（高/中/低优先级）
- 信息模糊点
- 规范符合度

## 3. 不足之处与改进建议

- 功能/技术/可测试性层面的问题
- 具体改进建议

## 4. 总体评估

- 可执行性评分（1-5）
- 是否可以开始 Plan
- 优先级建议

## 5. 具体改进建议

- 必须补充（阻塞开发）
- 强烈建议补充（提升质量）
- 可选补充（锦上添花）
```

---

## 审查要点速查表

**技术风险：** 技术可行性初步判断合理、依赖关系明确、无依赖风险

**业务风险：** 业务目标清晰、成功标准可量化、边界情况明确、错误处理充分

**执行风险：**

- 前端：UI 三态规则明确
- 后端：API 字段满足前端需求
- 全栈：数据流清晰
- 验收清单可测试

**规范符合：** 模板选择正确、命名规范一致、架构模式符合项目规范

**常见风险点：**

1. UI 规范不完整（缺少三态规则、状态流转、加载反馈）
2. 功能需求不明确（输入/输出、异常处理、边界情况）
3. 边界条件遗漏（异常情况、降级方案）
4. 依赖关系不明确（与其他 REQ 的交互点、现有系统影响）
5. 测试不可验证（验收标准模糊、验收检查清单不完整）
6. 用户旅程不清晰（入口、流程、反馈）
7. 成功标准不可量化（验证方式不明确）
8. 外部参考缺失（中等以上复杂度需求建议包含竞品对比、成功标准参考）

**注意**：以下内容在 Plan 阶段设计，Requirement 阶段不包含：

- API 规范（请求/响应/错误码）- 在 Plan 阶段设计
- 数据模型（表结构、字段约束）- 在 Plan 阶段设计
- 技术可行性详细分析 - 在 Plan 阶段设计

---

## 输出要求

- **输出方式**：审查结果直接输出到对话中，**不保存文档文件**
- **报告内容**：风险总结、缺失信息清单、改进建议、可执行性评估、具体修改建议
- **阻塞性问题处理**：如果发现阻塞性问题（Blockers），建议用户先更新 Requirement（使用 `/req <REQ-xxx>` 更新），再进入 Plan

## 注意事项

1. 客观评估，不臆测
2. 区分阻塞性问题和建议性问题
3. 提供可操作的改进建议
4. 基于项目规范评估
5. 关注可执行性，非完美度
6. **仅输出结果到对话，不创建或保存任何文档文件**
7. **如果发现阻塞性问题，建议用户先更新 Requirement，再进入 Plan**
